<!doctype html>
<html lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>リアルタイム音声文字起こし</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap"
        rel="stylesheet" />
    <link rel="stylesheet" href="/static/css/style.css" />
</head>

<body>
    <!-- トースト通知エリア -->
    <div id="toast-container" class="toast-container"></div>

    <div class="container">
        <header>
            <h1>🎤 リアルタイム音声文字起こし</h1>
            <p class="subtitle">累積バッファ方式による日本語音声認識</p>
        </header>

        <main>
            <!-- コントロール -->
            <section class="controls">
                <!-- 入力ソース選択 -->
                <div class="input-source-selector">
                    <label>
                        <input type="radio" name="inputSource" value="microphone" checked />
                        <span>マイク入力</span>
                    </label>
                    <label>
                        <input type="radio" name="inputSource" value="video" />
                        <span>動画ファイル</span>
                    </label>
                    <label>
                        <input type="radio" name="inputSource" value="tab" />
                        <span>タブ共有（YouTube等）</span>
                    </label>
                </div>

                <!-- マイク選択（デフォルト表示） -->
                <div id="microphone-controls" class="device-selector-wrapper">
                    <label for="device-selector">マイク:</label>
                    <select id="device-selector"></select>
                </div>

                <!-- 動画アップロード欄（デフォルト非表示） -->
                <div id="video-controls" class="video-upload" style="display: none;">
                    <label for="video-file-input">動画ファイルを選択:</label>
                    <input type="file" id="video-file-input" accept="video/*" />

                    <div class="sample-videos">
                        <p class="sample-label">サンプル動画:</p>
                        <button class="btn-sample" data-video="/sample/001-sibutomo.mp4">サンプル1（黒）</button>
                        <button class="btn-sample" data-video="/sample/002-worklife.mp4">サンプル2（青）</button>
                        <button class="btn-sample" data-video="/sample/003-sikouryou.mp4">サンプル3（緑）</button>
                    </div>

                    <!-- 動画要素はJavaScriptで動的に作成 -->
                </div>

                <!-- タブ共有の説明（デフォルト非表示） -->
                <div id="tab-controls" class="tab-share-info" style="display: none;">
                    <div class="info-box">
                        <h4>📺 タブ共有モード</h4>
                        <p>ブラウザで再生中のYouTube等の音声をリアルタイムで文字起こしします。</p>
                        <ol>
                            <li>「開始」ボタンをクリック</li>
                            <li>共有するタブを選択</li>
                            <li>「音声を共有」にチェック✅</li>
                            <li>「共有」ボタンをクリック</li>
                        </ol>
                        <p class="note">⚠️ 音声を共有するために、必ず「音声を共有」にチェックを入れてください。</p>
                    </div>
                </div>

                <!-- 処理オプション -->
                <div class="processing-options">
                    <h3>処理オプション</h3>
                    <div class="options-grid">
                        <label>
                            <input type="checkbox" id="enable-hiragana" />
                            <span>ひらがな正規化</span>
                        </label>
                        <label>
                            <input type="checkbox" id="enable-translation" />
                            <span>翻訳（日→英）</span>
                        </label>
                        <label>
                            <input type="checkbox" id="enable-summary" disabled />
                            <span>要約（将来実装予定）</span>
                        </label>
                    </div>
                    <p class="hint">💡 オフにすると処理が高速化されます</p>
                </div>

                <div class="button-group">
                    <button id="start-button" class="btn btn-primary">開始</button>
                    <button id="stop-button" class="btn btn-secondary" disabled>停止</button>
                    <button id="download-button" class="btn btn-tertiary" disabled>ダウンロード</button>
                </div>

                <div id="status-text" class="status info">準備中...</div>
            </section>

            <!-- 音量メーター -->
            <section class="volume-meter">
                <label>音量:</label>
                <div class="volume-bar-container">
                    <div id="volume-bar" class="volume-bar"></div>
                </div>
            </section>

            <!-- 文字起こし結果 -->
            <section class="transcription-results">
                <h2>文字起こし結果</h2>

                <div class="result-box">
                    <h3>確定テキスト</h3>
                    <div id="confirmed-text" class="text-display confirmed"></div>
                </div>

                <div class="result-box">
                    <h3>暫定テキスト</h3>
                    <div id="tentative-text" class="text-display tentative"></div>
                </div>
            </section>

            <!-- ひらがな正規化 -->
            <section class="hiragana-results" style="display: none;">
                <h2>ひらがな正規化</h2>
                <div id="hiragana-text" class="text-display hiragana"></div>
            </section>

            <!-- 翻訳結果（オプション） -->
            <section id="translation-section" class="translation-results" style="display: none;">
                <h2>翻訳結果</h2>

                <div class="result-box">
                    <h3>確定翻訳</h3>
                    <div id="confirmed-translation" class="text-display translation-confirmed"></div>
                </div>

                <div class="result-box">
                    <h3>暫定翻訳</h3>
                    <div id="tentative-translation" class="text-display translation-tentative"></div>
                </div>
            </section>

            <!-- パフォーマンス情報 -->
            <section class="performance">
                <h2>処理時間</h2>
                <div id="performance-info" class="performance-info"></div>
            </section>
        </main>

        <footer>
            <p>Voice Analyzer API</p>
        </footer>
    </div>

    <script src="/static/js/audio-capture.js"></script>
    <script src="/static/js/websocket-client.js"></script>
    <script src="/static/js/ui-controller.js"></script>
    <script src="/static/js/app.js"></script>
</body>

</html>
