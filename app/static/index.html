<!doctype html>
<html class="light" lang="ja">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ZenVoice - リアルタイム音声文字起こし</title>

    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="/static/favicon.svg" />
    <link rel="icon" type="image/png" sizes="48x48" href="/static/favicon-48x48.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
        href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&display=swap"
        rel="stylesheet" />
    <link
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&display=swap"
        rel="stylesheet" />

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,container-queries"></script>
    <script>
        tailwind.config = {
            darkMode: "class",
            theme: {
                extend: {
                    colors: {
                        primary: "#3B82F6",
                        "background-light": "#F1F5F9",
                        "background-dark": "#0F172A",
                    },
                    fontFamily: {
                        sans: ["'Noto Sans JP'", "sans-serif"],
                    },
                    borderRadius: {
                        card: "2rem",
                    },
                },
            },
        };
    </script>

    <link rel="stylesheet" href="/static/css/app.css" />
</head>

<body
    class="bg-background-light dark:bg-background-dark text-slate-800 dark:text-slate-200 min-h-screen flex flex-col">
    <!-- トースト通知エリア -->
    <div id="toast-container"></div>

    <!-- トリミングインジケーター -->
    <div id="trim-indicator" style="display: none">
        <span class="material-symbols-outlined text-sm">settings</span>
        <span>整理中...</span>
    </div>

    <!-- ヘッダー -->
    <header
        class="h-14 flex items-center justify-between px-4 md:px-8 bg-white/30 dark:bg-slate-900/30 backdrop-blur-md sticky top-0 z-50 shrink-0">
        <div class="flex items-center gap-4">
            <div class="w-6 h-6 bg-primary/10 rounded flex items-center justify-center">
                <span class="material-symbols-outlined text-primary text-lg">graphic_eq</span>
            </div>
        </div>
        <div class="flex items-center gap-3">
            <div id="status-text" class="status info">準備中...</div>
            <!-- モバイル専用: 設定ボタン -->
            <button
                id="settings-btn"
                class="md:hidden p-2 hover:bg-white dark:hover:bg-slate-800 rounded-2xl transition-colors text-slate-400"
                title="設定">
                <span class="material-symbols-outlined text-xl">tune</span>
            </button>
            <button
                id="dark-toggle"
                class="p-2 hover:bg-white dark:hover:bg-slate-800 rounded-2xl transition-colors text-slate-400">
                <span class="material-symbols-outlined text-xl">dark_mode</span>
            </button>
            <button
                id="zen-toggle"
                class="p-2 hover:bg-white dark:hover:bg-slate-800 rounded-2xl transition-colors text-slate-400"
                title="Zenモード">
                <span class="material-symbols-outlined text-xl">self_improvement</span>
            </button>
        </div>
    </header>

    <!-- メインレイアウト（3カラム） -->
    <main class="flex-1 flex flex-col md:flex-row overflow-hidden min-h-0">
        <!-- 左サイドバー -->
        <aside id="left-sidebar" class="hidden lg:flex lg:w-72 flex-col bg-transparent shrink-0">
            <div class="p-6">
                <button
                    class="w-full flex items-center justify-center p-4 bg-white dark:bg-slate-800 rounded-2xl shadow-sm hover:shadow-md transition-all border border-white/50 dark:border-slate-700">
                    <span class="material-symbols-outlined text-primary">add</span>
                </button>
            </div>
            <div class="flex-1 overflow-y-auto custom-scrollbar px-6 space-y-3">
                <div
                    class="p-5 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-blue-50 dark:border-blue-900/20">
                    <div class="text-xs text-slate-400 mb-1">今日</div>
                    <div class="text-sm font-medium text-slate-700 dark:text-slate-200 truncate">
                        新しいセッション
                    </div>
                </div>
            </div>
        </aside>

        <!-- 中央: 文字起こしエリア -->
        <section id="main-section" class="flex-1 flex flex-col overflow-hidden min-h-0">
            <div class="flex-1 flex flex-col items-center py-6 px-6 min-h-0">
                <div id="transcription-wrapper" class="w-full max-w-[700px] flex flex-col gap-5 flex-1 min-h-0">
                    <!-- 入力ソースエリア（録音開始でフェードアウト） -->
                    <div id="source-area">
                        <!-- pill型タブ -->
                        <div
                            id="source-tabs"
                            class="bg-white/50 dark:bg-slate-800/50 text-slate-400 p-1 rounded-2xl flex w-full md:max-w-xs md:self-center shadow-sm border border-white/20 dark:border-slate-700/30">
                            <button
                                class="source-btn active flex-1 justify-center px-4 md:px-6 py-2 rounded-2xl bg-white dark:bg-slate-800 shadow-sm text-sm font-medium text-slate-700 dark:text-slate-200 transition-all"
                                data-source="microphone">
                                マイク
                            </button>
                            <button
                                class="source-btn flex-1 justify-center px-4 md:px-6 py-2 rounded-2xl text-sm font-medium text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-all"
                                data-source="video">
                                ビデオ
                            </button>
                            <button
                                class="source-btn flex-1 justify-center px-4 md:px-6 py-2 rounded-2xl text-sm font-medium text-slate-400 hover:text-slate-600 dark:hover:text-slate-300 transition-all"
                                data-source="tab">
                                共有
                            </button>
                        </div>

                        <!-- 入力ソースコントロール -->
                        <div id="source-controls">
                            <!-- マイク選択 -->
                            <div
                                id="microphone-controls"
                                class="flex items-center gap-3 bg-white dark:bg-slate-800 text-slate-400 border border-slate-200/60 dark:border-slate-700/60 rounded-2xl px-4 py-2.5">
                                <span class="material-symbols-outlined text-slate-300 text-base shrink-0">mic</span>
                                <select
                                    id="device-selector"
                                    class="flex-1 min-w-0 text-sm bg-transparent text-slate-500 dark:text-slate-400 focus:outline-none border-0 ring-0 focus:ring-0 appearance-none p-0"></select>
                            </div>

                            <!-- 動画ファイル -->
                            <div id="video-controls" style="display: none">
                                <label
                                    for="video-file-input"
                                    class="flex items-center gap-2 px-4 py-2.5 bg-white dark:bg-slate-800 border border-slate-200/60 dark:border-slate-700/60 rounded-2xl text-sm text-slate-400 hover:text-slate-500 hover:border-slate-300 cursor-pointer transition-colors">
                                    <span class="material-symbols-outlined text-base">video_file</span>
                                    ファイルを選択
                                </label>
                                <input type="file" id="video-file-input" accept="video/*" class="hidden" />
                            </div>

                            <!-- タブ共有説明 -->
                            <div id="tab-controls" style="display: none">
                                <div
                                    class="flex items-center gap-3 bg-white dark:bg-slate-800 border border-slate-200/60 dark:border-slate-700/60 rounded-2xl px-4 py-2.5 text-slate-400">
                                    <span class="material-symbols-outlined text-xl shrink-0">screen_share</span>
                                    <p class="text-sm">
                                        開始後、共有するタブを選択して「音声を共有」にチェックしてください。
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- /#source-area -->

                    <!-- テキストカード -->
                    <div
                        id="transcription-card"
                        class="bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-white dark:border-slate-800/50 flex flex-col flex-1 min-h-0">
                        <!-- モバイル用タブ（md未満のみ表示） -->
                        <div
                            id="mobile-card-tabs"
                            class="md:hidden flex border-b border-slate-100 dark:border-slate-800 shrink-0">
                            <button class="mobile-tab-btn active" data-panel="transcription">文字起こし</button>
                            <button id="mobile-tab-hiragana" class="mobile-tab-btn hidden" data-panel="hiragana">
                                ひらがな
                            </button>
                            <button
                                id="mobile-tab-translation"
                                class="mobile-tab-btn hidden"
                                data-panel="translation">
                                翻訳
                            </button>
                        </div>

                        <!-- コンテンツパネル（共通ラッパー） -->
                        <div class="flex-1 min-h-0 relative">
                            <!-- 文字起こしパネル -->
                            <div id="mobile-panel-transcription" class="p-5 md:p-8 lg:p-12 h-full">
                                <div id="transcription-text" class="custom-scrollbar overflow-y-auto h-full"></div>
                            </div>

                            <!-- ひらがなパネル（モバイルのみ） -->
                            <div id="mobile-panel-hiragana" class="hidden p-5 h-full md:hidden">
                                <div
                                    id="hiragana-text-mobile"
                                    class="custom-scrollbar overflow-y-auto h-full"></div>
                            </div>

                            <!-- 翻訳パネル（モバイルのみ） -->
                            <div id="mobile-panel-translation" class="hidden p-5 h-full md:hidden">
                                <div
                                    id="translation-text-mobile"
                                    class="custom-scrollbar overflow-y-auto h-full"></div>
                            </div>
                        </div>

                        <!-- カード下部ボタン -->
                        <div id="card-controls" class="px-5 pb-6 md:px-8 md:pb-8 lg:px-12 lg:pb-10 shrink-0">
                            <div id="volume-row" class="flex justify-end mb-3">
                                <div id="volume-meter" class="w-14">
                                    <div class="h-px bg-slate-100 dark:bg-slate-800 rounded-full overflow-hidden">
                                        <div id="volume-bar"></div>
                                    </div>
                                </div>
                                <div
                                    id="video-time-display"
                                    class="text-xs text-slate-300 dark:text-slate-600 font-mono tracking-wide"
                                    style="display: none">
                                    <span id="video-current-time">00:00</span><span class="mx-1">/</span><span
                                        id="video-total-time">00:00</span>
                                </div>
                            </div>
                            <div class="flex items-center justify-end gap-4">
                                <!-- 状態インジケーター -->
                                <div id="state-indicator" class="state-indicator hidden">
                                    <span id="state-dot" class="state-dot"></span>
                                    <span id="state-label" class="state-label"></span>
                                </div>
                                <button
                                    id="download-button"
                                    class="p-3.5 rounded-2xl bg-slate-50 dark:bg-slate-800/50 text-slate-400 hover:text-primary transition-colors border border-slate-100 dark:border-slate-700"
                                    disabled>
                                    <span class="material-symbols-outlined">download</span>
                                </button>
                                <!-- 再生/停止トグルボタン（1ボタン） -->
                                <button
                                    id="start-button"
                                    class="w-14 h-14 rounded-full bg-primary flex items-center justify-center shadow-lg shadow-blue-500/30 hover:scale-105 active:scale-95 transition-all text-white">
                                    <span class="material-symbols-outlined font-bold text-2xl">play_arrow</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- 右サイドバー（md以上でのみ表示） -->
        <aside
            id="right-sidebar"
            class="hidden md:flex md:w-64 lg:w-80 flex-col p-4 md:p-6 gap-4 overflow-hidden shrink-0">
            <!-- ひらがなカード -->
            <div
                class="flex-1 flex flex-col bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-white dark:border-slate-800/50 min-h-0">
                <div class="flex items-center justify-between px-6 pt-5 pb-4 shrink-0">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-blue-500 text-lg">auto_fix_high</span>
                        <span class="text-sm font-bold text-slate-700 dark:text-slate-200">ひらがな</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span
                            class="px-2 py-0.5 bg-blue-50 dark:bg-blue-900/30 text-[10px] text-blue-500 font-bold rounded uppercase tracking-wider">AI</span>
                        <input type="checkbox" id="enable-hiragana" class="toggle-checkbox sr-only" />
                        <label for="enable-hiragana" class="toggle-label"></label>
                    </div>
                </div>
                <div class="hiragana-results card-body inactive flex-1 px-6 pb-5 min-h-0">
                    <div
                        id="hiragana-text"
                        class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed custom-scrollbar overflow-y-auto h-full">
                    </div>
                </div>
            </div>

            <!-- 翻訳カード -->
            <div
                class="flex-1 flex flex-col bg-white dark:bg-slate-900 rounded-2xl shadow-sm border border-white dark:border-slate-800/50 min-h-0">
                <div class="flex items-center justify-between px-6 pt-5 pb-4 shrink-0">
                    <div class="flex items-center gap-2">
                        <span class="material-symbols-outlined text-blue-500 text-lg">translate</span>
                        <span class="text-sm font-bold text-slate-700 dark:text-slate-200">翻訳</span>
                    </div>
                    <div class="flex items-center gap-2">
                        <span
                            class="px-2 py-0.5 bg-slate-50 dark:bg-slate-800 text-[10px] text-slate-400 font-bold rounded uppercase tracking-wider">EN</span>
                        <input type="checkbox" id="enable-translation" class="toggle-checkbox sr-only" />
                        <label for="enable-translation" class="toggle-label"></label>
                    </div>
                </div>
                <div id="translation-section" class="card-body inactive flex-1 px-6 pb-5 min-h-0">
                    <div
                        id="translation-text"
                        class="text-sm text-slate-500 dark:text-slate-400 leading-relaxed italic custom-scrollbar overflow-y-auto h-full">
                    </div>
                </div>
            </div>

            <!-- 要約カード（実装中） -->
            <div
                class="flex-1 flex flex-col bg-slate-50 dark:bg-slate-800/30 rounded-2xl border border-slate-100 dark:border-slate-700/50 min-h-0">
                <div class="flex items-center justify-between px-6 pt-5 pb-4 shrink-0">
                    <div class="flex items-center gap-2">
                        <span
                            class="material-symbols-outlined text-slate-300 dark:text-slate-600 text-lg">summarize</span>
                        <span class="text-sm font-bold text-slate-400 dark:text-slate-500">要約</span>
                    </div>
                    <span
                        class="px-2 py-0.5 bg-amber-50 dark:bg-amber-900/20 text-[10px] text-amber-400 dark:text-amber-500 font-bold rounded uppercase tracking-wider">実装中</span>
                </div>
                <div class="card-body inactive flex-1 px-6 pb-5 min-h-0">
                    <div
                        id="summary-text"
                        class="text-sm text-slate-400 dark:text-slate-500 leading-relaxed custom-scrollbar overflow-y-auto h-full">
                    </div>
                </div>
            </div>
        </aside>
    </main>

    <!-- モバイル設定ドロワー -->
    <div id="settings-overlay" class="fixed inset-0 bg-black/30 z-40 hidden"></div>
    <div
        id="settings-drawer"
        class="fixed bottom-0 left-0 right-0 z-50 bg-white dark:bg-slate-900 rounded-t-3xl shadow-2xl translate-y-full md:hidden">
        <div class="px-6 pt-5 pb-8">
            <!-- ハンドル -->
            <div class="w-10 h-1 bg-slate-200 dark:bg-slate-700 rounded-full mx-auto mb-5"></div>
            <!-- タイトル -->
            <div class="flex items-center justify-between mb-4">
                <span class="text-sm font-bold text-slate-700 dark:text-slate-200">処理オプション</span>
                <button
                    id="settings-close"
                    class="p-1.5 rounded-2xl hover:bg-slate-100 dark:hover:bg-slate-800 text-slate-400 transition-colors">
                    <span class="material-symbols-outlined text-xl">close</span>
                </button>
            </div>
            <!-- ひらがなトグル -->
            <div class="flex items-center justify-between py-4 border-b border-slate-100 dark:border-slate-800">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-blue-500 text-lg">auto_fix_high</span>
                    <span class="text-sm font-medium text-slate-700 dark:text-slate-200">ひらがな</span>
                    <span
                        class="px-2 py-0.5 bg-blue-50 dark:bg-blue-900/30 text-[10px] text-blue-500 font-bold rounded uppercase tracking-wider">AI</span>
                </div>
                <input type="checkbox" id="enable-hiragana-mobile" class="toggle-checkbox sr-only" />
                <label for="enable-hiragana-mobile" class="toggle-label"></label>
            </div>
            <!-- 翻訳トグル -->
            <div class="flex items-center justify-between py-4">
                <div class="flex items-center gap-2">
                    <span class="material-symbols-outlined text-blue-500 text-lg">translate</span>
                    <span class="text-sm font-medium text-slate-700 dark:text-slate-200">翻訳</span>
                    <span
                        class="px-2 py-0.5 bg-slate-50 dark:bg-slate-800 text-[10px] text-slate-400 font-bold rounded uppercase tracking-wider">EN</span>
                </div>
                <input type="checkbox" id="enable-translation-mobile" class="toggle-checkbox sr-only" />
                <label for="enable-translation-mobile" class="toggle-label"></label>
            </div>
        </div>
    </div>

    <!-- 非表示のラジオボタン（JSが参照） -->
    <div class="hidden">
        <input type="radio" name="inputSource" value="microphone" id="radio-microphone" checked />
        <input type="radio" name="inputSource" value="video" id="radio-video" />
        <input type="radio" name="inputSource" value="tab" id="radio-tab" />
    </div>

    <script src="/static/js/audio-capture.js"></script>
    <script src="/static/js/websocket-client.js"></script>
    <script src="/static/js/ui-controller.js"></script>
    <script src="/static/js/app.js"></script>

    <script src="/static/js/main.js"></script>
</body>

</html>
